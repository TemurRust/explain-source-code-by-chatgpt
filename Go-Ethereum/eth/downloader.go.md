# File: eth/downloader/downloader.go

eth/downloader/downloader.go文件是Go-Ethereum中的下载管理器模块，负责处理区块链同步和数据下载相关的逻辑。

MaxBlockFetch：每个对等节点最大允许的块下载数量。
MaxHeaderFetch：每个对等节点最大允许的头部下载数量。
MaxSkeletonSize：每个对等节点用于非完整同步时头部骨架的允许最大大小。
MaxReceiptFetch：每个对等节点最大允许的收据下载数量。
maxQueuedHeaders：下载队列中最大允许的头部数量。
maxHeadersProcess：每个轮次处理的头部数量。
maxResultsProcess：每个轮次处理的结果数量。
fullMaxForkAncestry：完全同步下用于跟踪分叉祖先的最大数量。
lightMaxForkAncestry：轻客户端同步下用于跟踪分叉祖先的最大数量。
reorgProtThreshold：触发分叉保护机制的阈值。
reorgProtHeaderDelay：分叉保护机制下的头部延迟。
fsHeaderSafetyNet：完全同步下的头部安全网络。
fsHeaderContCheck：完全同步下进行连续性检查的头部数量。
fsMinFullBlocks：完全同步下的最小完整块数量。
errBusy：忙错误类型。
errUnknownPeer：未知对等节点错误类型。
errBadPeer：错误的对等节点类型。
errStallingPeer：停滞对等节点错误类型。
errUnsyncedPeer：未同步对等节点错误类型。
errNoPeers：无对等节点错误类型。
errTimeout：超时错误类型。
errEmptyHeaderSet：空头部集错误类型。
errPeersUnavailable：无可用对等节点错误类型。
errInvalidAncestor：无效的祖先错误类型。
errInvalidChain：无效链错误类型。
errInvalidBody：无效块体错误类型。
errInvalidReceipt：无效收据错误类型。
errCancelStateFetch：取消状态获取错误类型。
errCancelContentProcessing：取消内容处理错误类型。
errCanceled：已取消错误类型。
errTooOld：过旧错误类型。
errNoAncestorFound：未找到祖先错误类型。
errNoPivotHeader：未找到中点头错误类型。
ErrMergeTransition：合并转换错误类型。

peerDropFn：当对等节点被标记为不可信或丢弃时的回调函数。
badBlockFn：处理坏块时的回调函数。

headerTask：下载和处理头部的任务。
Downloader：下载管理器结构体，管理所有下载相关的逻辑。
LightChain：轻客户端链结构体，管理轻客户端同步相关的逻辑。
BlockChain：完全节点链结构体，管理完全同步相关的逻辑。

New：创建新的下载管理器。
Progress：获取下载管理器同步进度。
Synchronising：判断是否正在同步中。
RegisterPeer：注册对等节点。
RegisterLightPeer：注册轻客户端对等节点。
UnregisterPeer：注销对等节点。
LegacySync：执行传统同步。
synchronise：同步区块链数据。
getMode：获取同步模式。
syncWithPeer：与对等节点同步数据。
spawnSync：启动同步过程。
cancel：取消同步过程。
Cancel：取消同步过程的函数。
Terminate：终止同步过程。
fetchHead：下载头部数据。
calculateRequestSpan：计算请求范围。
findAncestor：查找祖先块。
findAncestorSpanSearch：通过遍历查找祖先块。
findAncestorBinarySearch：通过二分查找查找祖先块。
fetchHeaders：下载头部数据。
fillHeaderSkeleton：填充头部骨架。
fetchBodies：下载块体数据。
fetchReceipts：下载收据数据。
processHeaders：处理下载的头部数据。
processFullSyncContent：处理完全同步的内容。
importBlockResults：导入块数据。
processSnapSyncContent：处理快照同步的内容。
splitAroundPivot：在中点头周围分割头部数据。
commitSnapSyncData：提交快照同步数据。
commitPivotBlock：提交中点块。
DeliverSnapPacket：传递快照数据包。
readHeaderRange：读取头部范围数据。
reportSnapSyncProgress：报告快照同步进度。

